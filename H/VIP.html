<!DOCTYPE html>
<html>
<head>
    <title>文档库</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; }
        .auth-box { padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        input { padding: 8px; margin: 10px 0; width: 200px; }
        button { background: #07C160; color: white; border: none; padding: 8px 16px; border-radius: 4px; }
        .pdf-list { margin-top: 20px; }
        .pdf-item { margin: 10px 0; }
    </style>
</head>
<body>
    <div id="authSection" class="auth-box">
        <h3>请输入访问ID</h3>
        <input type="text" id="inputId" placeholder="输入您的ID">
        <button onclick="checkAccess()">进入</button>
        <div id="errorMsg" style="color:red;display:none;margin-top:10px;"></div>
    </div>

    <div id="pdfSection" class="pdf-list" style="display:none;">
        <h2>可用文档</h2>
        <div id="pdfContainer"></div>
    </div>

    <script>
        // 加载有效ID列表
        async function loadIDs() {
            const response = await fetch('ids.txt');
            return (await response.text()).split('\n').map(id => id.trim());
        }

        // 加载PDF列表
        async function loadPDFs() {
            const response = await fetch('pdfs.txt');
            return (await response.text()).split('\n').map(line => {
                const [name, path] = line.split(',');
                return { name: name?.trim(), path: path?.trim() };
            }).filter(item => item.name && item.path);
        }

        // 验证访问权限
        async function checkAccess() {
            const inputId = document.getElementById('inputId').value;
            const validIDs = await loadIDs();
            const errorEl = document.getElementById('errorMsg');

            if (validIDs.includes(inputId)) {
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('pdfSection').style.display = 'block';
                showPDFList();
            } else {
                errorEl.textContent = 'ID无效，请重试';
                errorEl.style.display = 'block';
            }
        }

        // 显示文档列表
        async function showPDFList() {
            const pdfs = await loadPDFs();
            const container = document.getElementById('pdfContainer');
            
            pdfs.forEach(pdf => {
                const div = document.createElement('div');
                div.className = 'pdf-item';
                div.innerHTML = `
                    <a href="${pdf.path}" target="_blank">${pdf.name}</a>
                `;
                container.appendChild(div);
            });
        }
    </script>
</body>
</html>
